@model DemoAspMvcDt.HtmlHelpers.Datatables.RazorExtension.DtModel
<script>

    let dtModel = @Html.Raw(Json.Encode(Model));


    module_@Model.TableName = (function () {
        $(function () {

            let rawTableName = dtModel.TableName;

            let closestDiv = document.getElementById(`div__dt__${rawTableName}`); //This div is added in DtModel.cs --> ToString()

            let _jQueryTable = DtTableHtmlHelper.createTable(dtModel, closestDiv);


                         //Edit Column
            @if (Model.HasEditRowCommand)
            {
                <text>
            _jQueryTable.on('draw.dt', function () { DtEditCmd.setEditCmd(dtModel, _jQueryTable, rawTableName); });
                </text>
            }




                    // if true then the "ajax" call will not trigger on first time: See the "ajax" settings for the Datatable in the "dtCustomConfig" object
                    // NB: Must be placed here (just before the "dtCustomConfig")
                    // Used in 'DtModel.cd --> InitDataTableConfig --> Ajax config'
                    let _isDtAjaxLoadingDefferd  =dtModel.IsDtAjaxLoadingDefferd;

                     let dtCustomConfig =@Html.Raw(Model.CustomConfigValues);


                     //Will merge custom and default settings for the datatable: in this case, default settings will be overwritten by custom ones having same name
                     // To inverse the logic, do this instead: dtCustomConfig = $.extend({},dtCustomConfig, Model.defaultDtConfigValue());
            if (dtModel.HasDefaultSettings)
                    {
                        dtCustomConfig = $.extend({}, @Model.DefaultConfigValues (), dtCustomConfig);
                    }


                    let dtTable  = _jQueryTable .DataTable(dtCustomConfig);//Init dataTable

            if (dtModel.DoCreateDtApiInstance) //Create an instance for the DtApi
                    {
                            @Model.DtApiInstanceName = new DtApi(rawTableName); // will be a global variable
                    }

            if (dtModel.IsUsedInForm)
                    {
                DtFormHelper.setupForm(dtModel, closestDiv, dtTable, _jQueryTable);

                    }




            DtEventsHelper.setupEvents(dtModel, dtTable);

        });
    })();
</script>